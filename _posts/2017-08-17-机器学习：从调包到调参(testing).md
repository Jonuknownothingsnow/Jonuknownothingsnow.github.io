---
title: 机器学习：从调包到调参
catalog: 
- 数据与算法
date: 2017-08-15
---

最近和靖凯聊到关于机器学习算法的内容，要我推荐书，我当然是选择周志华的《机器学习》啦。不过话说回来我觉得初学者尤其我们这种野路子也不需要一开就猛啃算法原理，容易丧失信心。一开始当然是来快活调包啦（笑）

# 开始调包

作为一个使用python的脚本小子，要说机器学习调包一定是从scikit-learn开始。我最早入门也是网上一篇用鸢尾花数据集演示随机森林效果的教程开始的。现在那篇文章有点找不到了，我们同样还是使用鸢尾花数据集，对各种scikit-learn的各种算法进行演示，为了显示我不忘初心，就也从RamdomForest开始吧。

## 鸢尾花：RandomForest

首先简单介绍一下随机森林算法，随机森林是一种经典的集成学习算法，由多个决策树组成，每个决策树只使用数据集中的部分特征进行训练，最终通过所有的决策树一起投票进行分类。

我们使用鸢尾花数据集来演示下RandomForest

```python
#首先是数据载入以及初始的处理
import pandas as pd
from sklearn.ensemble import RandomForestClassifier
from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split
iris = load_iris()
df = pd.DataFrame(iris.data,columns=iris.feature_names)
df["tag"] = iris.target

#把总数据集割成训练集和测试集两个部分
train,test = train_test_split(df,test_size=0.1)#测试集为总体的1/10

#选择要使用的特征。在业务与比赛中这是相当关键复杂一步，但在这里我们就直接选取全部的特征就好了。
feature = iris.feature_names

#初始化模型。这一步实际上和设置参数是一起的，调参是现实工作中的另一大关键，这里当然我们也省略了。
#粗略地设了两个参数，一百颗决策树：n_estimator=100，调用全部的cpu核心：n_job=-1
rf = RandomForestClassifier(n_estimators=100,n_job=-1)

#训练模型
rf.fit(train[feature],train["tag"])

#使用模型进行预测
test["predict"] = rf.predict(train[feature])

#验证
```

基本的机器学习模型流程已经完整了，

```flow
st=>start: 开始
ed=>end: 结束
get_data=>operation: 获取数据(数据预处理等等)
set_feature=>operation: 设置使用的特征
set_params=>operation: 设置参数(初始化模型)
fit=>operation: 训练模型
predict=>operation: 预测结果

st->get_data->set_feature->set_params->fit->predict->ed
```







